<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans  
            http://www.springframework.org/schema/beans/spring-beans-3.2.xsd  
            http://www.springframework.org/schema/security  
            http://www.springframework.org/schema/security/spring-security-3.2.xsd">

    <!-- 不过滤登录页面 -->
    <security:http pattern="/login.jsp" security="none" />

    <!-- 配置SpringSecurity的http安全服务 -->
    <security:http auto-config="true">
        <!-- 只有ROLE_ADMIN权限用户才能访问/admin/**页面 -->
        <security:intercept-url pattern="/admin/**"
            access="ROLE_ADMIN" />

        <!-- 只有ROLE_ADMIN或ROLE_USER权限用户才能访问所有页面 -->
        <security:intercept-url pattern="/**"
            access="ROLE_ADMIN,ROLE_USER" />

    </security:http>

    <!-- 认证管理器，配置SpringSecutiry的权限信息 -->
    <security:authentication-manager>
        <security:authentication-provider>
            <!-- 帐户信息，指定用户名、密码和权限 -->
            <security:user-service>
                <security:user name="admin" password="admin"
                    authorities="ROLE_ADMIN,ROLE_USER" />
            </security:user-service>


        </security:authentication-provider>
    </security:authentication-manager>

</beans> 